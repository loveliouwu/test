# AES 高级加密标准

```
https://zh.wikipedia.org/wiki/%E9%AB%98%E7%BA%A7%E5%8A%A0%E5%AF%86%E6%A0%87%E5%87%86
```

>在密码学中又称为Rijndael加密法，是美国联邦政府采用的一种区块加密标准，这个标准用来替代原先的DES，已经成为**对称密钥加密**中最流行的算法之一

> 严格的说AES和Rijndael加密法并不完全一样，虽然在使用中两者可以呼唤，因为Rijindael加密法可以支持更大范围的区块和密钥长度，AES的区块长度固定为128bit，密钥长度可以是128，192，256，而Rijndael使用的密钥和区块长度均可以是128，192，256比特，加密过程中使用的密钥是由Rijndael密钥生成方案产生

> AES加密过程是在一个4*4的字节矩阵上运作，这个矩阵又称为”体“，其初值就是一个明文区块（矩阵中一个元素大小就是明文区块中的一个byte）
各轮AES加密循环（除最后一轮外）都包含4个步骤：

>
1. AddRoundKey--矩阵中的每一个字节都与该次**回合密钥**做XOR运算，每个子密钥由密钥生成方案产生
2. SubBytes--透过一个非线性的替代函数，用查找表的方式把每个字节替换成对应的字节。
3. ShiftRows--将矩阵中的每个横列进行循环式移位
4. MixColumns--为了充分混合矩阵中各个执行的操作，这个步骤使用线性转换来混合每内联的四个字节，最有一个加密循环中省略MixColumns步骤，而以另一个AddRoundKey取代
>


# DES 数据加密标准
>数据加密标准是一种对称密钥加密块密码算法，它基于56位密钥的对陈算法，这个算法因为包含一些机密设计元素，相对短的密钥长度以及怀疑内含美国国家安全局的后门而开始时有争议

> DES现在已经不是一种安全的加密方法，主要因为它使用的56位密钥过短，逐渐被AES所取代。



### s盒
>S盒为固定的8比特输入8比特输出的置换，记为Sbox()
在密码学中，一个S盒（Substitution-box，替换盒）是对称密钥加密算法执行替换计算的基本结构。在块密码中，它们通常用于模糊密钥与密文之间的关系——香农的混淆理论。

>通常，S-Box接受特定数量的输入比特m，并将其转换为特定数量的输出比特n，其中n 不一定等于m。一个m×n的S盒可以通过包含2m条目，每条目n比特的查找表实现。S盒通常是固定的（例如DES和AES加密算法）, 也有一些加密算法的S盒是基于密钥动态生成的（例如Blowfish和双鱼算法加密算法）。


# SMS4
### 密钥及密钥参量
>加密密钥长度为128比特，表示为MK(MK0,MK1,MK2,MK3) 其中每个MK为字，
轮密钥表示为(rk0，...,rk31)，rki为字。轮密钥由加密密钥生成。FK(FK0,FK1,FK2,FK3)为系统参数，CK(CK0，...，CK31)为固定参数，用于密钥扩展算法，都是字。


### 轮函数
```
F(X0,X1,X2,X3,rk) = X0 (异或) T(X1(异或)X2(异或)X3(异或)rk)
```

### 合成置换T
T:是一个可逆变换，由非线性变换t和线性变换L复合而成
```
T(x) = L(t(x))
```
### 非线性变换t
>t由4个并行的S盒构成  
设输入为`A = (a0,a1,a2,a3)`，输出为`B = (b0,b1,b2,b3)`，则  
`(b0,b1,b2,b3) = t(A) = (Sbox(a0),Sbox(a1),Sbox(a2),Sbox(a3))`

### 线性变换L
>非线性变换t的输出是线性变换L的输入，设输入为B，输出为C，则：  
`C = L(B) = B(异或)(B<<<2)(异或)(B<<<10)(异或)(B<<<18)(异或)(B<<<24)`

### S盒
>采用固定的S盒子

### **加/解密算法**
>定义反序变换R为:  
`R(A0,A1,A2,A3) = (A3,A2,A1,A0)`  
设明文输入为`(X0,X1,X2,X3)`，密文输出为`(Y0,Y1,Y2,Y3)`，轮密钥为rki 
则本算法的加密变换为:
` Xi+4 = F(Xi,X(i+1),X(i+2),X(i+3),rki) = Xi(异或)T(X(i+1)(异或)X(i+2)(异或)X(i+3)(异或)rki)`,i = 0,..31  
`(Y0,Y1,Y2,Y3) = R(X32,X33,X34,35) = (X35,X34,X33,X32)`  

>本算法的解密变换与加密变换结构相同，不同的仅是论密钥的使用顺序。  
加密时轮密钥使用顺序为`(rk0，...,rk31)`   
解密时轮密钥使用顺序为`(rk31，...,rk0)`


### 密钥扩展算法
本算法中加密算法的轮密钥由加密密钥通过密钥扩展算法生成:
加密密钥MK = (MK0,MK1,MK2,MK3)  
则轮密钥生成方法为：  
1. `(K0,K1,K2,K3) = (MK0^FK0,MK1^FK1,MK2^FK2,MK3^FK3)`  
2. 对i = 0,...31:  
        `rki = K(i+4) = Ki ^ T'(K(i+1) ^ K(i+2) ^ K(i+3) ^ CKi)`  
**说明**  
(1) T'变换与加解密算法轮函数中的T基本相同，只是将其中的线性变换L修改为以下L':  
`L'(B) = B ^ (B<<<13) ^ (B<<<23)`  
(2) 系统参数FK的取值，采用16进制表示为:
FK0 = (A3B1BAC6) ... FK3  
(3) 设CK(i,j)为CKi的第j字节(i=0,1...,31;j=0,1,2,3),即`CKi = (ck(i,0),ck(i,1),ck(i,2),ck(i,3))`,则ck(i,j) = (4i+j)*7 mod 256